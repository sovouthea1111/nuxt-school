import{g as j,a0 as N,a1 as I,a2 as w,N as u,H as B,k as E,i as H,a3 as F,E as x,s as M,L as q,a4 as h,a5 as A,a6 as T,a7 as z,a8 as P,a9 as U,aa as V,ab as W,ac as D,ad as G,F as J}from"./DIz7m-9I.js";const S=(a="RouteProvider")=>j({name:a,props:{route:{type:Object,required:!0},vnode:Object,vnodeRef:Object,renderKey:String,trackRootNodes:Boolean},setup(n){const o=n.renderKey,r=n.route,t={};for(const i in n.route)Object.defineProperty(t,i,{get:()=>o===n.renderKey?n.route[i]:r[i],enumerable:!0});return N(w,I(t)),()=>n.vnode?u(n.vnode,{ref:n.vnodeRef}):n.vnode}}),Q=S(),O=new WeakMap,ne=j({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},transition:{type:[Boolean,Object],default:void 0},keepalive:{type:[Boolean,Object],default:void 0},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(a,{attrs:n,slots:o,expose:r}){const t=B(),i=E(),d=H(w,null);let k;r({pageRef:i});const l=H(F,null);let s;const m=t.deferHydration();if(t.isHydrating){const e=t.hooks.hookOnce("app:error",m);x().beforeEach(e)}a.pageKey&&M(()=>a.pageKey,(e,y)=>{e!==y&&t.callHook("page:loading:start")});let c=!1;{const e=x().beforeResolve(()=>{c=!1});q(()=>{e()})}return()=>u(W,{name:a.name,route:a.route,...n},{default:e=>{const y=Y(d,e.route,e.Component),R=d&&d.matched.length===e.route.matched.length;if(!e.Component){if(s&&!R)return s;m();return}if(s&&l&&!l.isCurrent(e.route))return s;if(y&&d&&(!l||l?.isCurrent(d)))return R?s:null;const f=h(e,a.pageKey),_=Z(d,e.route,e.Component);!t.isHydrating&&k===f&&!_&&A(()=>{c=!0,t.callHook("page:loading:end")}),k=f;const g=!!(a.transition??e.route.meta.pageTransition??T),L=g&&X([a.transition,e.route.meta.pageTransition,T,{onAfterLeave(){delete t._runningTransition,t.callHook("page:transition:finish",e.Component)}}]),b=a.keepalive??e.route.meta.keepalive??z;return s=P(g&&L,U(b,u(V,{suspensible:!0,onPending:()=>{g&&(t._runningTransition=!0),t.callHook("page:start",e.Component)},onResolve:async()=>{await A();try{t._route.sync?.(),await t.callHook("page:finish",e.Component),delete t._runningTransition,!c&&!_&&(c=!0,await t.callHook("page:loading:end"))}finally{m()}}},{default:()=>{const C={key:f||void 0,vnode:o.default?$(o.default,e):e.Component,route:e.route,renderKey:f||void 0,trackRootNodes:g,vnodeRef:i};if(!b)return u(Q,C);const p=e.Component.type,K=p;let v=O.get(K);return v||(v=S(p.name||p.__name),O.set(K,v)),u(v,C)}}))).default(),s}})}});function X(a){const n=[];for(const o of a)o&&n.push({...o,onAfterLeave:o.onAfterLeave?D(o.onAfterLeave):void 0});return G(...n)}function Y(a,n,o){if(!a)return!1;const r=n.matched.findIndex(t=>t.components?.default===o?.type);return!r||r===-1?!1:n.matched.slice(0,r).some((t,i)=>t.components?.default!==a.matched[i]?.components?.default)||o&&h({route:n,Component:o})!==h({route:a,Component:o})}function Z(a,n,o){return a?n.matched.findIndex(t=>t.components?.default===o?.type)<n.matched.length-1:!1}function $(a,n){const o=a(n);return o.length===1?u(o[0]):u(J,void 0,o)}export{ne as _};
