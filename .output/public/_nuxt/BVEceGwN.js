import{g as A,k as v,j as c,c as n,a as s,l as x,v as M,A as B,F as f,r as b,m as C,o,t as u}from"./DIz7m-9I.js";import{u as L}from"./D9vpsezn.js";import{u as N}from"./B5aj7jcg.js";import"./CuQSOrhc.js";const V={class:"card"},$={class:"toolbar"},F={class:"table"},I={class:"badge"},U={key:0},z=A({__name:"reports",setup(D){const{grades:m}=L(),{students:g}=N();function i(a){return g.value.find(t=>t.id===a)?.name||"Unknown"}const d=v(""),r=v(""),h=c(()=>Array.from(new Set(m.value.map(a=>a.exam))).sort()),y=c(()=>{const a=d.value.trim().toLowerCase();return m.value.filter(t=>{const e=`${i(t.studentId)} ${t.subject}`.toLowerCase(),l=!r.value||t.exam===r.value;return(!a||e.includes(a))&&l})}),p=c(()=>{const a=new Map;return y.value.forEach(t=>{const e=`${t.studentId}::${t.subject}`,l=a.get(e)||{scores:[],latestExam:""};l.scores.push(t.score),l.latestExam=t.exam,a.set(e,l)}),Array.from(a.entries()).map(([t,e])=>{const[l,E]=t.split("::"),k=e.scores.length?Math.round(e.scores.reduce((S,_)=>S+_,0)/e.scores.length):0,j=e.scores.length?Math.max(...e.scores):0;return{key:t,student:i(l),subject:E,avg:k,max:j,latestExam:e.latestExam}}).sort((t,e)=>e.avg-t.avg)});return(a,t)=>(o(),n("section",V,[s("div",$,[x(s("input",{class:"input","onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),placeholder:"Filter by student or subject"},null,512),[[M,d.value]]),t[3]||(t[3]=s("div",{class:"spacer"},null,-1)),x(s("select",{class:"select","onUpdate:modelValue":t[1]||(t[1]=e=>r.value=e)},[t[2]||(t[2]=s("option",{value:""},"All Exams",-1)),(o(!0),n(f,null,b(h.value,e=>(o(),n("option",{key:e},u(e),1))),128))],512),[[B,r.value]])]),s("table",F,[t[5]||(t[5]=s("thead",null,[s("tr",null,[s("th",null,"Student"),s("th",null,"Subject"),s("th",null,"Avg"),s("th",null,"Best"),s("th",null,"Latest Exam")])],-1)),s("tbody",null,[(o(!0),n(f,null,b(p.value,e=>(o(),n("tr",{key:e.key},[s("td",null,u(e.student),1),s("td",null,u(e.subject),1),s("td",null,[s("span",I,u(e.avg),1)]),s("td",null,u(e.max),1),s("td",null,u(e.latestExam),1)]))),128)),p.value.length===0?(o(),n("tr",U,[...t[4]||(t[4]=[s("td",{colspan:"5",class:"muted"},"No grades",-1)])])):C("",!0)])])]))}});export{z as default};
