{"version":3,"file":"index-B3MWo10t.js","sources":["../../../../pages/grades/index.vue"],"sourcesContent":["<template>\n  <section class=\"card\">\n    <div class=\"toolbar\">\n      <input v-model=\"q\" class=\"input\" placeholder=\"Search student, subject or exam\" />\n      <div class=\"spacer\"></div>\n      <button class=\"btn\" @click=\"openCreate\">Add Grade</button>\n    </div>\n    <table class=\"table\">\n      <thead>\n        <tr>\n          <th>Student</th>\n          <th>Subject</th>\n          <th>Exam</th>\n          <th>Score</th>\n          <th>Date</th>\n          <th class=\"actions\">Actions</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"g in filtered\" :key=\"g.id\">\n          <td>{{ studentName(g.studentId) }}</td>\n          <td>{{ g.subject }}</td>\n          <td>{{ g.exam }}</td>\n          <td><span class=\"badge\">{{ g.score }}</span></td>\n          <td>{{ formatDate(g.date) }}</td>\n          <td class=\"actions\">\n            <button class=\"btn secondary\" @click=\"openEdit(g.id)\">Edit</button>\n            <button class=\"btn danger\" @click=\"handleDelete(g.id)\">Delete</button>\n          </td>\n        </tr>\n        <tr v-if=\"filtered.length === 0\">\n          <td colspan=\"6\" class=\"muted\">No grades found</td>\n        </tr>\n      </tbody>\n    </table>\n    <Popup :open=\"showCreate\" title=\"Add Grade\" @close=\"closeModal\">\n      <GradeForm :model-value=\"createModel\" @update:model-value=\"onUpdateCreate\" @submit=\"handleCreate\" @cancel=\"closeModal\" />\n    </Popup>\n    <Popup :open=\"showEdit\" title=\"Edit Grade\" @close=\"closeModal\">\n      <GradeForm :model-value=\"editModel\" @update:model-value=\"onUpdateEdit\" @submit=\"handleUpdate\" @cancel=\"closeModal\" />\n    </Popup>\n  </section>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, reactive, computed } from 'vue'\nimport Popup from '~/components/Popup.vue'\nimport GradeForm from '~/components/GradeForm.vue'\nimport { useGrades } from '~/composables/useGrades'\nimport { useStudents } from '~/composables/useStudents'\nconst { grades, create, update, remove, getById } = useGrades()\nconst { students } = useStudents()\nfunction studentName(id: string) { return students.value.find(s => s.id === id)?.name || 'Unknown' }\nconst q = ref('')\nconst filtered = computed(() => {\n  const v = q.value.trim().toLowerCase()\n  return grades.value.filter(g => {\n    const text = `${studentName(g.studentId)} ${g.subject} ${g.exam} ${g.score}`.toLowerCase()\n    return !v || text.includes(v)\n  }).sort((a,b) => b.date.localeCompare(a.date))\n})\ntype GradeModel = { studentId: string; subject: string; exam: string; score: number; date: string }\nconst showCreate = ref(false)\nconst showEdit = ref(false)\nconst editId = ref<string | null>(null)\nlet createModel = reactive<GradeModel>({ studentId: students.value[0]?.id || '', subject: 'Mathematics', exam: 'Midterm', score: 80, date: new Date().toISOString().slice(0,10) })\nlet editModel = reactive<GradeModel>({ studentId: students.value[0]?.id || '', subject: 'Mathematics', exam: 'Midterm', score: 80, date: new Date().toISOString().slice(0,10) })\nfunction openCreate() { showCreate.value = true }\nfunction openEdit(id: string) {\n  const g = getById(id); if (!g) return\n  editId.value = id\n  editModel.studentId = g.studentId\n  editModel.subject = g.subject\n  editModel.exam = g.exam\n  editModel.score = g.score\n  editModel.date = g.date.slice(0,10)\n  showEdit.value = true\n}\nfunction closeModal() { showCreate.value = false; showEdit.value = false }\nfunction onUpdateCreate(v: GradeModel) { Object.assign(createModel, v) }\nfunction onUpdateEdit(v: GradeModel) { Object.assign(editModel, v) }\nfunction handleCreate() { create({ ...createModel }); closeModal() }\nfunction handleUpdate() { if (!editId.value) return; update(editId.value, { ...editModel }); closeModal() }\nfunction handleDelete(id: string) { remove(id) }\nfunction formatDate(d: string) { return new Date(d).toLocaleDateString() }\n</script>\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderList","_ssrInterpolate","_push","_parent","_unref","_createVNode","GradeForm"],"mappings":"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"}