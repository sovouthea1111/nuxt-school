{"version":3,"file":"reports-KyGclYM-.js","sources":["../../../../pages/attendance/reports.vue"],"sourcesContent":["<template>\n  <section class=\"card\">\n    <div class=\"toolbar\">\n      <input class=\"date\" type=\"date\" v-model=\"from\" />\n      <input class=\"date\" type=\"date\" v-model=\"to\" />\n      <div class=\"spacer\"></div>\n      <button class=\"btn secondary\" @click=\"clearRange\">Clear Range</button>\n    </div>\n    <table class=\"table\">\n      <thead>\n        <tr>\n          <th>Student</th>\n          <th>Grade</th>\n          <th>Present</th>\n          <th>Absent</th>\n          <th>Late</th>\n          <th>Attendance Rate</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"row in summary\" :key=\"row.studentId\">\n          <td>{{ row.name }}</td>\n          <td><span class=\"badge\">{{ row.grade }}</span></td>\n          <td>{{ row.present }}</td>\n          <td>{{ row.absent }}</td>\n          <td>{{ row.late }}</td>\n          <td>{{ row.rate }}%</td>\n        </tr>\n        <tr v-if=\"summary.length === 0\">\n          <td colspan=\"6\" class=\"muted\">No data</td>\n        </tr>\n      </tbody>\n    </table>\n  </section>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from 'vue'\nimport { useStudents } from '~/composables/useStudents'\nimport { useAttendance } from '~/composables/useAttendance'\nconst { students } = useStudents()\nconst { records } = useAttendance()\nconst from = ref('')\nconst to = ref('')\nconst filtered = computed(() => {\n  return records.value.filter(r => {\n    const dateStr = r.date.slice(0,10)\n    const afterFrom = !from.value || dateStr >= from.value\n    const beforeTo = !to.value || dateStr <= to.value\n    return afterFrom && beforeTo\n  })\n})\nconst summary = computed(() => {\n  const map = new Map<string, { present: number; absent: number; late: number; total: number }>()\n  filtered.value.forEach(r => {\n    const m = map.get(r.studentId) || { present: 0, absent: 0, late: 0, total: 0 }\n    if (r.status === 'Present') m.present++\n    if (r.status === 'Absent') m.absent++\n    if (r.status === 'Late') m.late++\n    m.total++\n    map.set(r.studentId, m)\n  })\n  return Array.from(map.entries()).map(([id, m]) => {\n    const s = students.value.find(x => x.id === id)\n    const rate = m.total ? Math.round((m.present / m.total) * 100) : 0\n    return { studentId: id, name: s?.name || 'Unknown', grade: s?.grade || '-', present: m.present, absent: m.absent, late: m.late, rate }\n  }).sort((a,b) => b.rate - a.rate)\n})\nfunction clearRange() { from.value = ''; to.value = '' }\n</script>\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderList","_ssrInterpolate"],"mappings":";;;;;;;;;;;;;;;;;;;;AAwCA,UAAM,EAAE,SAAA,IAAa,YAAA;AACrB,UAAM,EAAE,QAAA,IAAY,cAAA;AACpB,UAAM,OAAO,IAAI,EAAE;AACnB,UAAM,KAAK,IAAI,EAAE;AACjB,UAAM,WAAW,SAAS,MAAM;AAC9B,aAAO,QAAQ,MAAM,OAAO,CAAA,MAAK;AAC/B,cAAM,UAAU,EAAE,KAAK,MAAM,GAAE,EAAE;AACjC,cAAM,YAAY,CAAC,KAAK,SAAS,WAAW,KAAK;AACjD,cAAM,WAAW,CAAC,GAAG,SAAS,WAAW,GAAG;AAC5C,eAAO,aAAa;AAAA,MACtB,CAAC;AAAA,IACH,CAAC;AACD,UAAM,UAAU,SAAS,MAAM;AAC7B,YAAM,0BAAU,IAAA;AAChB,eAAS,MAAM,QAAQ,CAAA,MAAK;AAC1B,cAAM,IAAI,IAAI,IAAI,EAAE,SAAS,KAAK,EAAE,SAAS,GAAG,QAAQ,GAAG,MAAM,GAAG,OAAO,EAAA;AAC3E,YAAI,EAAE,WAAW,UAAW,GAAE;AAC9B,YAAI,EAAE,WAAW,SAAU,GAAE;AAC7B,YAAI,EAAE,WAAW,OAAQ,GAAE;AAC3B,UAAE;AACF,YAAI,IAAI,EAAE,WAAW,CAAC;AAAA,MACxB,CAAC;AACD,aAAO,MAAM,KAAK,IAAI,QAAA,CAAS,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC,MAAM;AAChD,cAAM,IAAI,SAAS,MAAM,KAAK,CAAA,MAAK,EAAE,OAAO,EAAE;AAC9C,cAAM,OAAO,EAAE,QAAQ,KAAK,MAAO,EAAE,UAAU,EAAE,QAAS,GAAG,IAAI;AACjE,eAAO,EAAE,WAAW,IAAI,MAAM,GAAG,QAAQ,WAAW,OAAO,GAAG,SAAS,KAAK,SAAS,EAAE,SAAS,QAAQ,EAAE,QAAQ,MAAM,EAAE,MAAM,KAAA;AAAA,MAClI,CAAC,EAAE,KAAK,CAAC,GAAE,MAAM,EAAE,OAAO,EAAE,IAAI;AAAA,IAClC,CAAC;;uBAlEUA,eAAAC,WAAA,EAAA,OAAM,OAAA,GAAM,MAAA,CAAA,gFAEwB,KAAA,KAAI,2DACJ,GAAA,KAAE;AAgBvBC,oBAAA,QAAA,QAAP,QAAG;yBACLC,eAAA,IAAI,IAAI,iCACYA,eAAA,IAAI,KAAK,oBAC7BA,eAAA,IAAI,OAAO,aACXA,eAAA,IAAI,MAAM,aACVA,eAAA,IAAI,IAAI,aACRA,eAAA,IAAI,IAAI;;;AAEP,UAAA,QAAA,MAAQ,WAAM,GAAA;;;;;;;;;;;;;;;"}